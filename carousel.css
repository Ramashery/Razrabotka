/* public/carousel.css */

/* --- Carousel Specific Variables --- */
/* Mapped to existing site variables for consistency */
:root {
  --mzaC-fg: var(--color-text); /* Foreground text color */
  --mzaC-accent: var(--color-accent); /* Main accent color */
  --mzaC-accent2: #82a0ff; /* Secondary accent for gradients, can be adjusted */
  --mzaC-glass: var(--color-card); /* Background for card, semi-transparent */
  --mzaC-glow: rgba(184, 216, 232, 0.75); /* Glow effect, based on your accent */

  /* Original carousel layout variables */
  --mzaC-slideW: min(880px, 90vw); /* Width of a single slide */
  --mzaC-peek: 0.15; /* How much of the next/prev slide is visible */
  --mzaPagH: 64px; /* Height reserved for pagination */
  --mzaCardH: clamp(360px, 62vh, 600px); /* Height of the card */
}

/* --- Base Carousel Styles --- */
/* Note: `html, body` styles from original carousel are omitted as they conflict with main site styles.
   The carousel is designed to fit within a section of your existing page. */

.mzaCarousel {
  position: relative;
  /* Adjust height if carousel is not meant to be full viewport height.
     For a section within a page, a fixed height or min-height might be better. */
  height: 700vh; 
  max-width: 100vw;
  margin: 0 auto;
  padding: 0 18px;
  overflow: hidden;
  contain: layout paint; /* Optimize rendering performance */
  touch-action: none; /* Disable default touch actions to handle custom dragging */
}

.mzaCarousel-viewport {
  position: relative;
  outline: none;
  overflow: hidden;
  height: 100%;
}

.mzaCarousel-track {
  position: relative;
  /* Calculate track height based on viewport and pagination height */
  height: calc(100% - var(--mzaPagH) - max(env(safe-area-inset-bottom), 12px));
  transform-style: preserve-3d; /* Enable 3D transformations for parallax effect */
  perspective: 1200px; /* Perspective for 3D depth */
  overflow: hidden;
}

.mzaCarousel-slide {
  position: absolute;
  top: calc(50% + 5px); /* Vertically center with a slight offset */
  left: 50%; /* Horizontally center */
  width: var(--mzaC-slideW);
  height: min(var(--mzaCardH), calc(100% - 50px));
  transform-style: preserve-3d;
  display: grid;
  place-items: center;
  border-radius: 22px;
  overflow: hidden;
  will-change: transform, filter; /* Hint to browser for animation optimization */
}

.mzaCard {
  position: relative;
  width: 100%;
  height: 100%;
  border-radius: inherit;
  overflow: hidden;
  background: var(--mzaC-glass); /* Semi-transparent background */
  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.45); /* Shadow for depth */
  backdrop-filter: saturate(120%) blur(4px); /* Glassmorphism effect */
  transform: translateZ(0); /* Force hardware acceleration */
  cursor: grab; /* Indicate draggable element */
}

.mzaCard::before {
  content: "";
  position: absolute;
  inset: -2%; /* Slightly larger than the card for parallax effect */
  background-image: var(--mzaCard-bg); /* Dynamic background image from JS */
  background-size: cover;
  background-position: center;
  filter: contrast(1.02) saturate(1.08) brightness(0.9); /* Subtle image adjustments */
  transform: translateZ(-60px) scale(1.18)
    translate3d(var(--mzaParBgX, 0px), var(--mzaParBgY, 0px), 0); /* Parallax background */
  transition: transform 800ms cubic-bezier(0.2, 0.7, 0, 1),
    filter 800ms cubic-bezier(0.2, 0.7, 0, 1); /* Smooth transitions */
}

.mzaCard::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(
    180deg,
    rgba(0, 0, 0, 0.25),
    rgba(0, 0, 0, 0.45) 45%,
    rgba(0, 0, 0, 0.25) 100%
  ); /* Overlay for text readability */
}

.mzaCard-head {
  position: absolute;
  inset: 20px auto auto 20px; /* Position top-left */
  z-index: 2; /* Ensure text is above overlays */
}

.mzaCard-title {
  margin: 0;
  font-weight: 800;
  letter-spacing: 0.2px;
  font-size: clamp(22px, 3.1vw, 38px);
  text-shadow: 2px 2px 15px rgba(0, 0, 0, 0.6);
  line-height: 110%;
  cursor: text;
}

.mzaCard-kicker {
  margin: 0.5rem 0;
  color: var(--mzaC-accent); /* Accent color for kicker text */
  font-size: clamp(12px, 1.7vw, 14px);
  font-weight: 600;
  text-shadow: 1px 1px 10px rgba(0, 0, 0, 0.6);
  cursor: text;
}

.mzaCard-text {
  display: -webkit-box; /* For line-clamp */
  line-clamp: 3;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
  position: absolute;
  inset: auto 20px 85px 20px; /* Position bottom-left */
  z-index: 2;
  max-width: 60ch;
  background-color: rgba(0, 0, 0, 0.4); /* Semi-transparent background for text */
  padding: 20px;
  backdrop-filter: blur(5px); /* Blur for text background */
  -webkit-backdrop-filter: blur(5px);
  border-radius: 10px;
  text-wrap: balance;
  cursor: text;
  color: #ddd; /* Lighter text color */
  overflow: hidden;
}

.mzaCard-actions {
  position: absolute;
  inset: auto auto 18px 18px; /* Position bottom-left for actions */
  z-index: 2;
}

.mzaBtn {
  appearance: none;
  border: 1px solid var(--mzaC-accent); /* Border with accent color */
  border-radius: 14px;
  padding: 15px 20px;
  font-weight: 700;
  color: #0b0e13; /* Dark text for contrast on light button */
  background-image: linear-gradient(
    180deg,
    #9ef7d2, #97ebc8, #8fe0be, #88d5b5, #81c9ab, #7abea2, #73b398, #6ca88f, #659d86, #5e937d, #588874, #517e6b
  ); /* Greenish gradient */
  box-shadow: 0 3px 15px var(--mzaC-glow); /* Glow effect */
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.mzaBtn:active {
  transform: translateY(1px);
  box-shadow: 0 3px 10px rgba(130, 160, 255, 0.25);
}

/* --- Carousel Controls (Prev/Next Buttons) --- */
.mzaCarousel-controls {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  pointer-events: none; /* Allow clicks to pass through by default */
}

.mzaCarousel-prev,
.mzaCarousel-next {
  pointer-events: auto; /* Re-enable clicks for buttons */
  position: relative;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  border: 0;
  background: rgba(255, 255, 255, 0.08); /* Semi-transparent background */
  backdrop-filter: blur(6px); /* Blur effect */
  color: var(--mzaC-fg);
  font-size: 22px;
  display: grid;
  place-items: center;
  cursor: pointer;
  transition: background 0.2s ease, transform 0.2s ease;
}

.mzaCarousel-prev {
  margin-left: 6px;
}

.mzaCarousel-next {
  margin-right: 6px;
}

.mzaCarousel-prev:hover,
.mzaCarousel-next:hover {
  background: rgba(255, 255, 255, 0.14);
}

.mzaCarousel-prev:active,
.mzaCarousel-next:active {
  transform: scale(0.98);
}

/* --- Carousel Pagination (Dots) --- */
.mzaCarousel-pagination {
  position: absolute;
  left: 0;
  right: 0;
  bottom: max(27px, env(safe-area-inset-bottom)); /* Position at the bottom */
  display: flex;
  gap: 10px;
  justify-content: center;
  align-items: center;
  pointer-events: auto;
}

.mzaCarousel-dot {
  width: 12px;
  height: 12px;
  border-radius: 999px; /* Circular dots */
  background: rgba(255, 255, 255, 0.25);
  border: 0;
  cursor: pointer;
  transition: transform 0.2s ease, background 0.2s ease;
}

.mzaCarousel-dot[aria-selected="true"] {
  background: linear-gradient(180deg, var(--mzaC-accent2), var(--mzaC-accent)); /* Gradient for active dot */
  transform: scale(1.35);
}

/* --- Carousel Progress Bar --- */
.mzaCarousel-progress {
  position: fixed; /* Fixed at the bottom of the viewport */
  left: 0;
  right: 0;
  bottom: 0;
  height: 4px;
  background: rgba(255, 255, 255, 0.08);
  z-index: 9999;
  overflow: hidden;
}

.mzaCarousel-progressBar {
  display: block;
  height: 100%;
  width: 100vw;
  transform-origin: left;
  transform: scaleX(0); /* Initially hidden */
  will-change: transform;
  background: linear-gradient(90deg, var(--mzaC-accent), var(--mzaC-accent2));
}

/* --- Active Slide Effects --- */
.mzaCarousel-slide[data-state="active"] .mzaCard::before {
  filter: contrast(1.06) saturate(1.12) brightness(1.02); /* Enhanced filter for active slide */
}

.mzaCarousel-slide[data-state="active"] .mzaCard {
  box-shadow: 0 30px 70px rgba(0, 0, 0, 0.55),
    0 0 0 1px rgba(255, 255, 255, 0.04) inset; /* Stronger shadow for active slide */
}

/* --- Parallax Elements --- */
.mzaPar-1,
.mzaPar-2,
.mzaPar-3 {
  will-change: transform;
  transition: transform 500ms cubic-bezier(0.2, 0.7, 0, 1); /* Smooth parallax movement */
}

/* Different parallax strengths */
.mzaPar-1 {
  transform: translate3d(
    calc(var(--mzaParX, 0px) * 0.35),
    calc(var(--mzaParY, 0px) * 0.35),
    0
  );
}
.mzaPar-2 {
  transform: translate3d(
    calc(var(--mzaParX, 0px) * 0.25),
    calc(var(--mzaParY, 0px) * 0.25),
    0
  );
}
.mzaPar-3 {
  transform: translate3d(
    calc(var(--mzaParX, 0px) * 0.18),
    calc(var(--mzaParY, 0px) * 0.18),
    0
  );
}

/* --- Responsive Adjustments --- */
@media (max-width: 1000px) {
  :root {
    --mzaC-slideW: min(92vw, 620px);
  }
  .mzaCard-head {
    inset: 16px auto auto 16px;
  }
  .mzaCard-title {
    font-size: clamp(20px, 5.4vw, 30px);
  }
  .mzaCard-kicker {
    font-size: clamp(12px, 3.6vw, 13px);
  }
  .mzaCard-text {
    inset: auto 16px 62px 16px;
  }
}

@media (max-width: 768px) {
  :root {
    --mzaC-slideW: min(94vw, 560px);
  }
  .mzaCard-text,
  .mzaCard-title,
  .mzaCard-kicker {
    max-width: 45%; /* Limit width for better layout on smaller screens */
  }
  .mzaCard-text::after {
    position: absolute;
    width: 100%;
    height: 100%;
    inset: 0;
    background-image: linear-gradient(
      0deg,
      rgba(0, 0, 0, 1) 2%,
      rgba(0, 0, 0, 0) 25%
    ); /* Fade out text at the bottom */
    content: "";
    z-index: 1;
  }
}

@media (max-width: 560px) {
  :root {
    --mzaC-slideW: min(96vw, 520px);
  }
}

/* Hide elements based on viewport height for very small screens */
@media (max-height: 400px) {
  .mzaCard-text {
    display: none;
  }
}

@media (max-height: 280px) {
  .mzaCard-kicker {
    display: none;
  }
}

@media (max-height: 240px) {
  .mzaBtn {
    display: none;
  }
}